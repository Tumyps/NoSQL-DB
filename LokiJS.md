# LokiJS

![](/images/LokiJS.png)

# История развития СУБД

LokiJS - это небольшая встроенная база данных, написанная на JavaScript. Разработка LokiJS началась в 2014 году Джоном Долларом (John M. Doller), который является главным разработчиком проекта.

Идея создания LokiJS возникла, когда Джон Доллар работал над приложением для управления пакетами Node.js. Он заметил, что существующие решения для хранения данных в памяти были неэффективными и не могли удовлетворить требования его проекта. Поэтому он решил создать свою собственную базу данных, которая была бы легковесной, быстрой и эффективной для использования в приложениях Node.js.

Первая версия LokiJS была выпущена в 2014 году, и с тех пор проект активно развивался. В 2015 году была выпущена версия 1.0, которая включала в себя множество новых функций, таких как индексация данных, сжатие и сериализация. В 2016 году LokiJS стал частью проекта Node.js, что подтвердило его статус надежной базы данных для Node.js.

С тех пор LokiJS продолжает развиваться и улучшаться. В 2017 году была выпущена версия 2.0, которая добавила поддержку IndexedDB и WebSQL, что позволило использовать LokiJS как базу данных в браузере. В 2018 году была выпущена версия 3.0, которая включала в себя новые функции, такие как транзакции и улучшенный поиск.

Сегодня LokiJS остается популярной базой данных для Node.js и браузеров, которая используется многими разработчиками для создания легковесных и быстрых приложений.

# Инструменты для взаимодействия с СУБД
LokiJS - это база данных, написанная на JavaScript, которая предоставляет API для взаимодействия с данными. Для работы с LokiJS можно использовать различные инструменты, включая:

Node.js - LokiJS можно использовать в приложениях Node.js, чтобы хранить данные в памяти или на диске. Для этого нужно установить модуль LokiJS с помощью менеджера пакетов npm.

Браузер - LokiJS можно использовать в браузере, чтобы хранить данные локально. Для этого нужно подключить файлы LokiJS и его зависимостей к HTML-странице.

API - LokiJS предоставляет API для взаимодействия с данными, которое можно использовать в своих приложениях на JavaScript.

GUI - для работы с LokiJS можно использовать графический интерфейс пользователя (GUI), такой как adminMongo или mongo-express.

Консоль - LokiJS можно использовать через консоль, введя соответствующие команды для работы с данными.

Кроме того, существуют сторонние библиотеки и инструменты для работы с LokiJS, такие как LokiDB, LokiJS-express и LokiJS-React. Эти инструменты облегчают работу с LokiJS в приложениях, использующих соответствующие технологии.
# Какой database engine используется в вашей СУБД?

LokiJS - это база данных, которая использует свой собственный движок хранения данных, написанный на JavaScript. В отличие от традиционных реляционных баз данных, LokiJS не использует SQL или другие языки запросов для взаимодействия с данными.

Вместо этого LokiJS использует индексированные объекты JavaScript для хранения и поиска данных. Каждая коллекция данных в LokiJS представлена объектом, который содержит массив объектов данных. Данные хранятся в памяти или на диске, в зависимости от того, как настроена база данных.

# Как устроен язык запросов в вашей СУБД? 
LokiJS не использует SQL или другие стандартные языки запросов для взаимодействия с данными. Вместо этого он предоставляет свой собственный API и язык запросов, основанный на JavaScript.

Язык запросов в LokiJS состоит из набора методов, которые могут быть вызваны на коллекции данных, представленных объектом. Например, чтобы получить все элементы коллекции, можно вызвать метод find():

``` javascript
var collection = db.getCollection('myCollection');

var results = collection.find();
```
Этот код найдет все элементы в коллекции myCollection и вернет их в виде массива объектов.

Для поиска элементов, удовлетворяющих определенному условию, можно использовать метод find() с параметром запроса:

``` javascript
var results = collection.find({ age: { $gte: 18 }});
```

Этот код найдет все элементы в коллекции, у которых значение поля age больше или равно 18.

Также в LokiJS есть возможность сортировки, группировки, агрегации и других операций над данными.

В целом, язык запросов в LokiJS довольно гибкий и позволяет выполнять множество операций над данными. Однако он не является стандартным языком запросов и может потребовать некоторого времени для освоения.


# Возможно ли распределение файлов БД по разным носителям?
Да, LokiJS позволяет распределять файлы базы данных по разным носителям, включая память, файловую систему и IndexedDB.

По умолчанию, LokiJS хранит данные в памяти, что означает, что данные будут потеряны при завершении работы приложения. Однако, LokiJS позволяет сохранять данные на диске, используя различные плагины, такие как fs-storage для Node.js и loki-cordova-fs-storage для Cordova. Эти плагины позволяют сохранять данные на локальном диске в формате JSON, что обеспечивает переносимость данных между разными платформами.

# На каком языке/ах программирования написана СУБД?
LokiJS написан на языке программирования JavaScript, который является широко используемым языком программирования в веб-разработке и для написания серверного кода с использованием платформы Node.js.

LokiJS использует множество функций, доступных в языке JavaScript, таких как объекты, массивы, функции, замыкания и многие другие. Он также использует некоторые расширения, такие как Promise, Map, Set, Proxy и другие, которые были добавлены в язык JavaScript в более поздних версиях.

# Какие типы индексов поддерживаются в БД? Приведите пример создания индексов.

LokiJS поддерживает несколько типов индексов, включая индексирование значений полей, хранение значений в виде массива и поиск по полнотекстовому индексу.

1. Индексирование значений полей
Для создания индекса на поле, вы можете вызвать метод ensureIndex на коллекции, указав название поля, на которое нужно создать индекс:

``` javascript
// Создание индекса на поле 'name' в коллекции 'users'
var users = db.getCollection('users');
users.ensureIndex('name');
```
2. Индексирование значений в виде массива
Вы также можете создавать индексы, которые хранят значения полей в виде массивов, что позволяет быстро находить объекты, у которых есть общие значения в этом поле. Для этого вы можете вызвать метод ensureIndex с объектом настроек, указав массив в качестве значения для ключа field.

``` javascript
// Создание индекса на поле 'tags' в коллекции 'posts'
var posts = db.getCollection('posts');
posts.ensureIndex({
  field: 'tags',
  type: 'inverted'
});
```
3. Полнотекстовый индекс
LokiJS также поддерживает создание полнотекстовых индексов, которые позволяют выполнять поиск по фрагменту текста. Для этого необходимо установить плагин full-text-search и вызвать метод ensureIndex с опцией type: 'fulltext':

``` javascript
// Создание полнотекстового индекса на поле 'title' в коллекции 'posts'
var posts = db.getCollection('posts');
posts.ensureIndex({
  field: 'title',
  type: 'fulltext'
});
```
Таким образом, LokiJS поддерживает несколько типов индексов, которые позволяют быстро выполнять запросы к данным. Создание индексов в LokiJS просто и интуитивно понятно, и не требует большого количества кода.
# Как строится процесс выполнения запросов в вашей СУБД?
Процесс выполнения запросов в LokiJS состоит из нескольких шагов:

1. Парсинг запроса

Первым шагом является парсинг запроса, который состоит из анализа запроса на предмет выделения имен коллекций, полей, операторов и других параметров.

2. Создание объекта запроса

Затем создается объект запроса, который содержит информацию о типе запроса, имена коллекций и полей, используемые в запросе, а также операторы и другие параметры.

3. Поиск индекса

Далее происходит поиск подходящего индекса, который может быть использован для выполнения запроса. Если индекс найден, он используется для быстрого поиска подходящих записей в коллекции. Если индекс не найден, выполняется полный перебор коллекции.

4. Выполнение запроса

После того, как найден подходящий индекс, выполняется запрос. Этот шаг может варьироваться в зависимости от типа запроса и используемых операторов. Например, если запрос содержит операторы сравнения, выполняется проверка каждой записи в коллекции на соответствие критериям запроса.

5. Возвращение результатов

Последним шагом является возвращение результатов выполнения запроса. Результаты могут быть возвращены в виде массива объектов, где каждый объект представляет одну запись из коллекции, которая удовлетворяет критериям запроса.

# Есть ли для вашей СУБД понятие «план запросов»? Если да, объясните, как работает данный этап.

В LokiJS понятие "план запросов" отсутствует, поскольку запросы выполняются напрямую в коллекциях без необходимости составления плана запроса.

# Поддерживаются ли транзакции в вашей СУБД? Если да, то расскажите о нем. Если нет, то существует ли альтернатива?

LokiJS не поддерживает полноценные транзакции, так как это не является одной из его основных функциональных возможностей. Однако, существуют способы реализации похожего поведения, например, с использованием пакета lokijs-transactional, который добавляет поддержку транзакций к LokiJS.

Пакет lokijs-transactional реализует семантику транзакций, позволяя группировать несколько операций в одну транзакцию и выполнять их либо полностью, либо откатывать транзакцию при возникновении ошибки. При этом все операции, связанные с транзакцией, выполняются атомарно, то есть либо все операции применяются, либо ни одна.

# Какие методы восстановления поддерживаются в вашей СУБД. Расскажите о них.

LokiJS не поддерживает никаких специальных методов восстановления, так как все изменения в базе данных хранятся в памяти и автоматически сохраняются в файл при вызове метода saveDatabase().

Однако, LokiJS поддерживает автоматическое восстановление базы данных при старте. Если файл базы данных был поврежден или удален, LokiJS автоматически создаст новую пустую базу данных, и все коллекции будут созданы заново. Это может привести к потере данных, если последний вызов saveDatabase() был выполнен до краха системы.

Чтобы минимизировать потери данных в случае аварийного завершения работы приложения, рекомендуется использовать регулярное автоматическое сохранение базы данных в файл. Это можно сделать, например, используя таймер или событие завершения работы приложения для вызова метода saveDatabase().

# Расскажите про шардинг в вашей конкретной СУБД. Какие типы используются? Принцип работы.

LokiJS не поддерживает шардинг данных, так как все данные хранятся в памяти и хранятся в единственном файле базы данных.

# Возможно ли применить термины Data Mining, Data Warehousing и OLAP в вашей СУБД?

Термины Data Mining, Data Warehousing и OLAP могут быть использованы в контексте работы с данными в LokiJS, хотя LokiJS не является полноценной базой данных для анализа данных, такой как Oracle, SQL Server или PostgreSQL.

Data Mining - в LokiJS можно применять алгоритмы машинного обучения для поиска скрытых зависимостей и шаблонов в данных. LokiJS предоставляет возможности для построения индексов и выполнения запросов на выборку данных, которые можно использовать для анализа данных и применения алгоритмов машинного обучения.

Data Warehousing - LokiJS может использоваться как хранилище данных, но, в отличие от Data Warehouse, не поддерживает специальных механизмов для интеграции и обработки данных из различных источников. Тем не менее, LokiJS может использоваться для хранения данных, полученных из различных источников, и для выполнения запросов на выборку данных для анализа.

OLAP (Online Analytical Processing) - LokiJS поддерживает агрегирование данных, что позволяет выполнять многомерный анализ данных, но не предоставляет функциональности OLAP, такой как срезы, дрелинг, ротации и прочее. Тем не менее, LokiJS может быть использован для хранения и анализа данных в рамках OLAP-подобных процессов.

Таким образом, термины Data Mining, Data Warehousing и OLAP могут быть использованы в контексте работы с данными в LokiJS, но необходимо учитывать, что LokiJS не является полноценной базой данных для анализа данных и не поддерживает все функции, которые предоставляют полноценные базы данных для анализа данных.

# Какие методы защиты поддерживаются вашей СУБД? Шифрование трафика, модели авторизации и т.п.

LokiJS не поддерживает встроенных механизмов шифрования данных и моделей авторизации, поскольку это не является основной задачей этой базы данных. LokiJS является легковесной встраиваемой базой данных для хранения и обработки данных на клиентской стороне, которая не предназначена для масштабирования на серверах или доступа из сети. Она обычно используется в качестве альтернативы использованию локальных файлов или кэша браузера.

Таким образом, LokiJS не поддерживает встроенных механизмов шифрования данных и моделей авторизации, но для защиты данных можно использовать внешние библиотеки и механизмы, если LokiJS используется в приложении, которое имеет доступ к сети или к другим пользователям.

# Какие сообщества развивают данную СУБД? Кто в проекте имеет права на коммит и создание дистрибутива версий? Расскажите об этих людей и/или компаниях.

LokiJS является open-source проектом, разработка которого ведется сообществом разработчиков из разных стран мира. Основным разработчиком и поддерживающей компанией является Techfort, а также сообщество разработчиков на Github.

Среди ключевых разработчиков, которые внесли значительный вклад в развитие проекта, можно назвать Joe Minichino, основатель Techfort, а также Patrick Carey, Daniel Nordh, Daniel Hofstetter и других активных участников сообщества.

# Как продолжить самостоятельное изучение языка запросов с помощью демобазы. Если демобазы нет, то создайте ее.
Для продолжения самостоятельного изучения языка запросов LokiJS можно использовать демонстрационную базу данных, которую можно создать самостоятельно. Для этого выполним следующие шаги:

1. Установите LokiJS, если он еще не установлен. Это можно сделать с помощью npm командой:
```
npm install lokijs
```
2. Создайте новый файл с расширением .js и назовите его, например, demo-db.js.

3. Определите в коде необходимые переменные и объекты. Например:

``` javascript
const loki = require('lokijs');

// создаем экземпляр базы данных
const db = new loki('demo-db');

// создаем коллекцию
const users = db.addCollection('users');
```

Заполните коллекцию данными. Например, добавим несколько пользователей:
``` javascript
users.insert({
  name: 'John',
  age: 30,
  gender: 'male'
});

users.insert({
  name: 'Jane',
  age: 25,
  gender: 'female'
});

users.insert({
  name: 'Bob',
  age: 45,
  gender: 'male'
});
```

5. Выполните запросы к коллекции, используя язык запросов LokiJS. Например, чтобы выбрать всех пользователей мужского пола, старше 35 лет, можно использовать следующий код:
``` javascript
const results = users.chain()
  .find({ gender: 'male', age: { $gte: 35 } })
  .simplesort('age')
  .data();
console.log(results);
```

6. Запустите скрипт и проверьте результаты.
Таким образом, можно создавать и заполнять коллекции в базе данных LokiJS и выполнять различные запросы для изучения языка запросов.

# Где найти документацию и пройти обучение

Документацию по LokiJS можно найти на официальном сайте проекта: https://lokijs.org/. На этом сайте вы найдете подробное руководство по использованию LokiJS, а также примеры использования и документацию API.

В качестве обучающего ресурса вы можете рассмотреть курсы и документацию по NoSQL базам данных в целом, так как LokiJS является NoSQL базой данных. Кроме того, на платформе Udemy есть курсы, посвященные LokiJS, например, "Building a Realtime Chat Application using LokiJS and Socket.io".

Также существуют множество блогов, форумов и сообществ, где можно задавать вопросы и получать советы по использованию LokiJS. Некоторые из таких ресурсов:

Официальный форум LokiJS: https://groups.google.com/g/lokijs

Сообщество LokiJS на Reddit: https://www.reddit.com/r/lokijs/

Сообщество LokiJS на GitHub: https://github.com/techfort/LokiJS/community

Кроме того, LokiJS имеет довольно подробную документацию API, доступную на официальном сайте проекта: https://lokijs.org/#/docs. В документации API вы найдете подробную информацию о каждом методе и свойстве LokiJS, а также примеры использования.

# Как быть в курсе происходящего
Чтобы быть в курсе происходящего в мире LokiJS, можно следить за официальными каналами связи с проектом. Некоторые из таких каналов:

Официальный сайт LokiJS: https://lokijs.org/

Страница проекта на GitHub: https://github.com/techfort/LokiJS

Официальный форум LokiJS: https://groups.google.com/g/lokijs

Сообщество LokiJS на Reddit: https://www.reddit.com/r/lokijs/

Кроме того, следить за новостями и обновлениями LokiJS можно через социальные сети, такие как Twitter и LinkedIn. Также можно подписаться на рассылки новостей и обновлений на официальном сайте проекта.
